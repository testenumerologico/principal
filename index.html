<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teste Numerológico</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      color: white;
      height: 100vh;
      max-height: 100vh;
      width: 100vw;
      max-width: 100vw;
      overflow: hidden;
      display: flex;
      align-items: center;
      flex-direction: column;
      background-image: url('imgs/bg.jpg');
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    #logo {
      display: block;
      padding: 10px;
      width: 300px;
    }
    #textHeader {
      width: 70vw;
      text-align: center;
    }
    #textHeader h1 {
      padding: 0;
      margin: 0;
      margin-top: 10px;
      font-size: 1.5em;
    }
    #textHeader h2 {
      font-size: 1.2em;
      font-weight: 100;
      margin-top: 20px;
    }
    #numerologyForm {
      display: block;
      text-align: center;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 30px 10px;
      width: 30vw;
      border-radius: 10px;
    }
    #result {
      margin-top: 20px;
      text-align: center;
    }
    .result-section {
      display: none;
      margin-bottom: 40px;
    }
    .active {
      display: block;
    }
    form {
      display: inline-block;
      text-align: left;
    }
    input {
      margin-top: 5px;
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
    }
    input[type="text"] {
      text-align: center;
      width: 235px;
      height: 30px;
    }
    input[type="number"] {
      width: 60px;
      text-align: center;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    button[type="submit"] {
      background-color: #de6eff;
      border: none;
      border-radius: 5px;
      color: white;
      font: inherit;
      cursor: pointer;
      padding: 10px 20px;
    }
    button[type="submit"]:hover {
      background-color: white;
      color: #de6eff;
    }
    .seuNumeroE {
      font: inherit;
      font-size: 1.2em;
    }
    .large-bold {
      font-size: 7.5em;
      font-weight: bold;
    }
    .sectionDescription {
      font: inherit;
      font-size: 1.2em;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    #captions {
      display: none;
      width: 50vw;
      font-size: 1.2em;
      margin-top: 10px;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 10px 5px;
      color: white;
      border-radius: 5px;
      text-align: center;
      min-height: 1.5em;
      position: absolute;
      bottom: 70px;
    }
    #controls {
      margin-top: 10px;
    }
    #pauseButton, #resumeButton {
      width: 30px;
      cursor: pointer;
      display: none;
    }
    .imgControl {
      border-radius: 5px;
      position: absolute;
      bottom: 0px;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    #boxUnlockButton {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    #unlockButton {
      padding: 10px 20px;
      font-size: 1em;
      margin-top: 20px;
      cursor: pointer;
      background-color: #ffca2c;
      color: black;
      border-radius: 10px;
      border: 0;
      animation: zoom 0.5s infinite alternate;
    }
    #unlockButton:hover {
      background-color: black;
      color: #ffca2c;
    }
    #boxCircle {
      display: none;
      opacity: 0;
      position: absolute;
      top: 55%;
      left: 50%;
      transform: translate(-50%, -50%);
      transition: all 1s ease-in-out;
      overflow: hidden;
    }
    #circulo {
      animation: rotacionar 20s infinite linear;
      width: 25vw;
    }
    @keyframes rotacionar {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    @keyframes zoom {
      0% { transform: scale(1); }
      100% { transform: scale(1.1); }
    }
    @media (max-width: 768px) {
      #logo {
        width: 70vw;
      }
      #numerologyForm {
        width: 70vw;
      }
      #textHeader h1 {
        font-size: 1.2em;
      }
      #textHeader h2 {
        font-size: 0.9em;
      }
      #boxCircle {
        top: 53%;
      }
      #circulo {
        width: 93vw;
      }
      #captions {
        width: 90vw;
      }
    }
  </style>
</head>
<body>
  <img id="logo" src="imgs/logo.png" alt="Logo">
  <div id="textHeader">
    <h1>Descubra o significado NUMEROLÓGICO do seu nome e do dia que nasceu</h1>
    <h2>Preencha os campos abaixo para receber sua leitura numerológica 100% grátis</h2>
  </div>
  <form id="numerologyForm">
    <label for="fullName">Nome Completo:</label>
    <input type="text" id="fullName" name="fullName" placeholder="Escreva Seu Nome Completo" required><br><br>
    <label>Data de Nascimento:</label>
    <input type="number" id="birthDay" name="birthDay" placeholder="Dia" min="1" max="31" required>
    <input type="number" id="birthMonth" name="birthMonth" placeholder="Mês" min="1" max="12" required>
    <input type="number" id="birthYear" name="birthYear" placeholder="Ano" min="1900" max="2100" required><br><br>
    <button type="submit">COMEÇAR</button>
  </form>
  <div id="result">
    <div class="result-section" id="lifePathSection">
      <h3 id="lifePathSectionTitle"></h3>
      <p id="lifePathSectionIntro" class="seuNumeroE"></p>
      <p id="lifePathNumberText"></p>
      <p id="lifePathSectionNumberDisplay" class="large-bold"></p>
      <p id="lifePathSectionDescription" class="sectionDescription"></p>
    </div>
    <div class="result-section" id="expressionSection">
      <h3 id="expressionSectionTitle"></h3>
      <p id="expressionSectionIntro" class="seuNumeroE"></p>
      <p id="expressionSectionNumberText"></p>
      <p id="expressionSectionNumberDisplay" class="large-bold"></p>
      <p id="expressionSectionDescription" class="sectionDescription"></p>
    </div>
    <div class="result-section" id="soulUrgeSection">
      <h3 id="soulUrgeSectionTitle"></h3>
      <p id="soulUrgeSectionIntro" class="seuNumeroE"></p>
      <p id="soulUrgeSectionNumberText"></p>
      <p id="soulUrgeSectionNumberDisplay" class="large-bold"></p>
      <p id="soulUrgeSectionDescription" class="sectionDescription"></p>
    </div>
    <div class="result-section" id="personalitySection">
      <h3 id="personalitySectionTitle"></h3>
      <p id="personalitySectionIntro" class="seuNumeroE"></p>
      <p id="personalitySectionNumberText"></p>
      <p id="personalitySectionNumberDisplay" class="large-bold"></p>
      <p id="personalitySectionDescription" class="sectionDescription"></p>
    </div>
    <div id="boxCircle">
      <img id="circulo" src="imgs/circulo1.png" alt="Círculo">
    </div>
  </div>
  <div id="captions" class="captions"></div>
  <div id="controls">
    <img id="pauseButton" class="imgControl" src="imgs/pause.jpg" alt="Pausar">
    <img id="resumeButton" class="imgControl" src="imgs/play.jpg" alt="Retomar">
  </div>
  <div id="boxUnlockButton">
    <button id="unlockButton">DESBLOQUEAR MINHA PROSPERIDADE</button>
  </div>
  
  <script>
    // Funções de cálculo numerológico
    const letterToNumber = {
      A: 1, J: 1, S: 1,
      B: 2, K: 2, T: 2,
      C: 3, L: 3, U: 3,
      D: 4, M: 4, V: 4,
      E: 5, N: 5, W: 5,
      F: 6, O: 6, X: 6,
      G: 7, P: 7, Y: 7,
      H: 8, Q: 8, Z: 8,
      I: 9, R: 9
    };

    function reduceNumber(num) {
      if ([11, 22, 33].includes(num)) {
        return num;
      }
      while (num > 9) {
        num = num.toString().split('').reduce((a, b) => a + parseInt(b), 0);
        if ([11, 22, 33].includes(num)) {
          return num;
        }
      }
      return num;
    }

    function calculateLifePathNumber(day, month, year) {
      const digits = [...day.toString(), ...month.toString(), ...year.toString()].map(Number);
      const sum = digits.reduce((a, b) => a + b, 0);
      return reduceNumber(sum);
    }

    function calculateExpressionNumber(name) {
      let sum = 0;
      const upperName = name.toUpperCase();
      for (let char of upperName) {
        if (letterToNumber[char]) {
          sum += letterToNumber[char];
        }
      }
      return reduceNumber(sum);
    }

    function calculateSoulUrgeNumber(name) {
      const vowels = ['A', 'E', 'I', 'O', 'U'];
      let sum = 0;
      const upperName = name.toUpperCase();
      for (let char of upperName) {
        if (vowels.includes(char) && letterToNumber[char]) {
          sum += letterToNumber[char];
        }
      }
      return reduceNumber(sum);
    }

    function calculatePersonalityNumber(name) {
      const vowels = ['A', 'E', 'I', 'O', 'U'];
      let sum = 0;
      const upperName = name.toUpperCase();
      for (let char of upperName) {
        if (!vowels.includes(char) && letterToNumber[char]) {
          sum += letterToNumber[char];
        }
      }
      return reduceNumber(sum);
    }

    // Objeto com as descrições numerológicas
    const numerologyDescriptions = {
      lifePath: {
        1: "Líder nato, independente e ambicioso.",
        2: "Diplomático, cooperativo e sensível.",
        3: "Criativo, comunicativo e sociável.",
        4: "Prático, organizado e trabalhador.",
        5: "Aventureiro, versátil e livre.",
        6: "Responsável, cuidadoso e amoroso.",
        7: "Introspectivo, analítico e espiritual.",
        8: "Ambicioso, eficiente e focado no sucesso.",
        9: "Humanitário, idealista e compassivo.",
        11: "Iluminado, intuitivo e visionário.",
        22: "Mestre construtor, realiza grandes sonhos com estrutura.",
        33: "Mestre altruísta, inspirador e servidor da humanidade."
      },
      expression: {
        1: "Expressa-se com liderança e iniciativa.",
        2: "Comunica-se com sensibilidade e cooperação.",
        3: "Mostra criatividade e habilidades comunicativas.",
        4: "Demonstra organização e disciplina.",
        5: "Expressa-se de forma versátil e adaptável.",
        6: "Comunica com responsabilidade e cuidado.",
        7: "Expressa-se de maneira introspectiva e analítica.",
        8: "Mostra ambição e foco no sucesso.",
        9: "Comunica-se de forma humanitária e compassiva.",
        11: "Expressa ideias visionárias e inspiradoras.",
        22: "Comunica de maneira estruturada e impactante.",
        33: "Expressa compaixão profunda e altruísmo."
      },
      soulUrge: {
        1: "Deseja ser independente e líder.",
        2: "Anseia por harmonia e parcerias.",
        3: "Deseja expressar criatividade e alegria.",
        4: "Anseia por estabilidade e ordem.",
        5: "Deseja liberdade e aventura.",
        6: "Anseia por amor e responsabilidade.",
        7: "Deseja conhecimento e introspecção.",
        8: "Anseia por sucesso material e poder.",
        9: "Deseja contribuir para o bem comum.",
        11: "Deseja iluminação espiritual e compreensão profunda.",
        22: "Deseja construir algo grandioso e duradouro.",
        33: "Deseja servir à humanidade de forma altruísta."
      },
      personality: {
        1: "Projeção de liderança e iniciativa.",
        2: "Projeção de sensibilidade e cooperação.",
        3: "Projeção de criatividade e sociabilidade.",
        4: "Projeção de organização e disciplina.",
        5: "Projeção de versatilidade e adaptabilidade.",
        6: "Projeção de responsabilidade e cuidado.",
        7: "Projeção de introspecção e análise.",
        8: "Projeção de ambição e eficiência.",
        9: "Projeção de humanitarismo e compaixão.",
        11: "Projeção de inspiração e intuição elevada.",
        22: "Projeção de realização e construção de sonhos.",
        33: "Projeção de altruísmo e serviço humanitário."
      }
    };

    // NOVA FUNÇÃO: Apresentação Contínua usando AudioContext
    async function startContinuousPresentation() {
      // Cria o AudioContext e garante que ele esteja ativo (desbloqueado pelo gesto do usuário)
      const audioContext = new AudioContext();
      if (audioContext.state === 'suspended') {
        await audioContext.resume();
      }
      
      // Captura os valores do formulário
      const day = parseInt(document.getElementById('birthDay').value);
      const month = parseInt(document.getElementById('birthMonth').value);
      const year = parseInt(document.getElementById('birthYear').value);
      const name = document.getElementById('fullName').value.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
      
      // Calcula os números numerológicos
      const lifePath = calculateLifePathNumber(day, month, year);
      const expression = calculateExpressionNumber(name);
      const soulUrge = calculateSoulUrgeNumber(name);
      const personality = calculatePersonalityNumber(name);
      
      // Define os passos da apresentação – ajuste os caminhos dos áudios e as atualizações de UI conforme necessário
      const steps = [
        {
          // Passo 1: Áudio introdutório do Caminho de Vida
          audioSrc: 'audios/numero_caminho_de_vida.ogg',
          ui: () => {
            document.getElementById('textHeader').style.display = 'none';
            document.getElementById('lifePathSection').style.display = 'block';
            document.getElementById('lifePathSectionTitle').innerText = 'Número do Caminho de Vida';
          }
        },
        {
          // Passo 2: Áudio "Seu número do Caminho de Vida é"
          audioSrc: 'audios/lifePathSectionIntro.ogg',
          ui: () => {
            document.getElementById('lifePathSectionIntro').innerText = 'Seu número do Caminho de Vida é';
          }
        },
        {
          // Passo 3: Áudio com o número do Caminho de Vida
          audioSrc: `audios/lp${lifePath}.ogg`,
          ui: () => {
            document.getElementById('lifePathSectionNumberDisplay').innerText = lifePath;
          }
        },
        {
          // Passo 4: Áudio com a descrição do Caminho de Vida
          audioSrc: `audios/lp${lifePath}_desc.ogg`, // Certifique-se de ter esse arquivo ou ajuste conforme necessário
          ui: () => {
            const desc = numerologyDescriptions.lifePath[lifePath] || "Descrição não disponível.";
            document.getElementById('lifePathSectionDescription').innerText = desc;
          }
        },
        // Exemplo para o número de Expressão
        {
          audioSrc: 'audios/numero_de_expressao.ogg',
          ui: () => {
            document.getElementById('lifePathSection').style.display = 'none';
            document.getElementById('expressionSection').style.display = 'block';
            document.getElementById('expressionSectionTitle').innerText = 'Número de Expressão';
          }
        },
        {
          audioSrc: 'audios/expressionSectionIntro.ogg',
          ui: () => {
            document.getElementById('expressionSectionIntro').innerText = 'Seu número de Expressão é';
          }
        },
        {
          audioSrc: `audios/e${expression}.ogg`,
          ui: () => {
            document.getElementById('expressionSectionNumberDisplay').innerText = expression;
          }
        },
        {
          audioSrc: `audios/e${expression}_desc.ogg`,
          ui: () => {
            const desc = numerologyDescriptions.expression[expression] || "Descrição não disponível.";
            document.getElementById('expressionSectionDescription').innerText = desc;
          }
        },
        // Você pode adicionar passos para soulUrge e personality seguindo o mesmo padrão...
        // Passo Final: Texto/Áudio final
        {
          audioSrc: (() => {
            const finalOptions = ['audios/pros1.ogg', 'audios/pros2.ogg', 'audios/pros3.ogg'];
            return finalOptions[Math.floor(Math.random() * finalOptions.length)];
          })(),
          ui: () => {
            // Esconde as seções anteriores e exibe o botão de desbloqueio
            document.getElementById('expressionSection').style.display = 'none';
            document.getElementById('personalitySection').style.display = 'none';
            document.getElementById('soulUrgeSection').style.display = 'none';
            document.getElementById('boxUnlockButton').style.display = 'inline-block';
          }
        }
      ];
      
      // Agenda a reprodução contínua e as atualizações da interface
      let startTime = audioContext.currentTime;
      for (let step of steps) {
        // Carrega o áudio
        const response = await fetch(step.audioSrc);
        const arrayBuffer = await response.arrayBuffer();
        const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
        
        // Cria a fonte de áudio e agenda a reprodução
        const source = audioContext.createBufferSource();
        source.buffer = audioBuffer;
        source.connect(audioContext.destination);
        source.start(startTime);
        
        // Agenda a atualização da interface no mesmo instante
        setTimeout(step.ui, (startTime - audioContext.currentTime) * 1000);
        
        // Atualiza o tempo para o próximo passo
        startTime += audioBuffer.duration;
      }
    }
    
    // Evento do formulário: ao enviar, chama a nova função de apresentação contínua
    document.getElementById('numerologyForm').addEventListener('submit', async function(event) {
      event.preventDefault();
      // Oculta o formulário
      document.getElementById('numerologyForm').style.display = 'none';
      
      try {
        await startContinuousPresentation();
      } catch (error) {
        console.error("Erro na apresentação contínua:", error);
        alert("Ocorreu um erro durante a apresentação. Por favor, tente novamente.");
      }
    });
    
    // Evento para o botão de desbloqueio
    document.getElementById('unlockButton').addEventListener('click', () => {
      window.location.href = 'https://centralguia.github.io/101/';
    });
  </script>
</body>
</html>
